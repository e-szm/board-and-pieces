"use strict";

import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";
import StackedBarChart from "./data-visuals/chart-types/stacked-bar-chart.js";
import LineChart from "./data-visuals/chart-types/line-chart.js";
import ScatterPlot from "./data-visuals/chart-types/scatterplot.js";

/////////////////////////////////////////////////
// Opening Statistics
/////////////////////////////////////////////////

const barChart = new StackedBarChart({
  heading: "Top Openings",
  canvas: d3.select(".canvas--opening-stats"),
  keys: ["wins", "draws", "losses"],
  filterGroups: [["color", ["white", "black"]]],
  sortGroups: [["most", ["total", "wins", "losses"]]],
});

const openingStatsRes = [
  {
    opening: "Reti Opening",
    moves: "1 Nf3 Nf6",
    total: 1,
    wins: 0,
    losses: 0,
    draws: 1,
    code: "A05",
    color: "white",
  },
  {
    opening: "Queen's Pawn Game",
    moves: "1 d4 Nf6",
    total: 1,
    wins: 0,
    losses: 0,
    draws: 1,
    code: "A45",
    color: "black",
  },
  {
    opening: "English",
    moves: "1 c4 Nf6 2 Nc3",
    total: 1,
    wins: 0,
    losses: 1,
    draws: 0,
    code: "A16",
    color: "black",
  },
  {
    opening: "Robatsch",
    moves: "1 e4 g6",
    total: 1,
    wins: 0,
    losses: 1,
    draws: 0,
    code: "B06",
    color: "black",
  },
  {
    opening: "Three Knights",
    moves: "1 e4 e5 2 Nf3 Nc6 3 Nc3",
    total: 1,
    wins: 1,
    losses: 0,
    draws: 0,
    code: "C46",
    color: "white",
  },
  {
    opening: "King's Indian, Samisch Variation",
    moves: "1 d4 Nf6 2 c4 g6 3 Nc3 Bg7 4 e4 d6 5 f3",
    total: 1,
    wins: 1,
    losses: 0,
    draws: 0,
    code: "E80",
    color: "black",
  },
  {
    opening: "Pirc, Austrian Attack",
    moves: "1 e4 d6 2 d4 Nf6 3 Nc3 g6 4 f4",
    total: 1,
    wins: 1,
    losses: 0,
    draws: 0,
    code: "B09",
    color: "black",
  },
  {
    opening: "Bird's Opening",
    moves: "1 f4",
    total: 1,
    wins: 1,
    losses: 0,
    draws: 0,
    code: "A02",
    color: "black",
  },
  {
    opening: "Pirc, Classical",
    moves: "1 e4 d6 2 d4 Nf6 3 Nc3 g6 4 Nf3",
    total: 2,
    wins: 1,
    losses: 1,
    draws: 0,
    code: "B08",
    color: "black",
  },
  {
    opening: "King's Indian",
    moves: "1 d4 Nf6 2 c4 g6 3 Nc3",
    total: 3,
    wins: 1,
    losses: 2,
    draws: 0,
    code: "E61",
    color: "black",
  },
  {
    opening: "King's Indian Attack",
    moves: "1 Nf3 d5 2 g3 c5 3 Bg2",
    total: 5,
    wins: 3,
    losses: 2,
    draws: 0,
    code: "A08",
    color: "white",
  },
  {
    opening: "Reti Opening",
    moves: "1 Nf3",
    total: 15,
    wins: 9,
    losses: 5,
    draws: 1,
    code: "A04",
    color: "white",
  },
  {
    opening: "King's Indian Attack",
    moves: "1 Nf3 d5 2 g3",
    total: 22,
    wins: 9,
    losses: 12,
    draws: 1,
    code: "A07",
    color: "white",
  },
  {
    opening: "Pirc",
    moves: "1 e4 d6 2 d4 Nf6",
    total: 33,
    wins: 18,
    losses: 13,
    draws: 2,
    code: "B07",
    color: "black",
  },
];

barChart.createLegend("rect");
barChart.initializeTooltip(barChart.canvas, "bar");
barChart.bindData(openingStatsRes);

/////////////////////////////////////////////////
// Rating Trend
/////////////////////////////////////////////////

const ratingTrendRes = [
  {
    rating: 1731,
    date: "2024-03-01T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1741,
    date: "2024-03-02T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1750,
    date: "2024-03-04T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1749.3333333333333,
    date: "2024-03-05T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1772.1666666666667,
    date: "2024-03-06T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1764.4,
    date: "2024-03-08T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1799,
    date: "2024-03-09T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1788.1666666666667,
    date: "2024-03-11T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1770,
    date: "2024-03-12T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1784.1666666666667,
    date: "2024-03-13T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1788.5,
    date: "2024-03-14T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1785.6666666666667,
    date: "2024-03-15T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1794.2,
    date: "2024-03-18T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1790.25,
    date: "2024-03-19T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1783,
    date: "2024-03-20T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1783.3333333333333,
    date: "2024-03-21T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 946,
    date: "2024-03-22T00:00:00.000Z",
    time_class: "daily",
  },
  {
    rating: 946,
    date: "2024-03-25T00:00:00.000Z",
    time_class: "daily",
  },
  {
    rating: 1786.75,
    date: "2024-03-25T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1780.6666666666667,
    date: "2024-03-26T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1784.5454545454545,
    date: "2024-03-27T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 1778.1666666666667,
    date: "2024-03-28T00:00:00.000Z",
    time_class: "rapid",
  },
  {
    rating: 946,
    date: "2024-03-30T00:00:00.000Z",
    time_class: "daily",
  },
];
ratingTrendRes.forEach((el) => (el.date = new Date(el.date)));

const lineChart = new LineChart({
  heading: "Rating Trend",
  canvas: d3.select(".canvas--rating-trends"),
  filterGroups: [["time_class", ["rapid", "daily", "blitz", "bullet"]]],
  sortGroups: [],
});

lineChart.initializeTooltip(lineChart.canvas, "circle");
lineChart.bindData(ratingTrendRes);

/////////////////////////////////////////////////
// Duration Stats
/////////////////////////////////////////////////

const durationRes = [
  {
    _id: "663506d2de23f494a65a07ac",
    end_time: "2024-03-01T14:37:27.000Z",
    num_moves: 19,
    start_time: "2024-03-01T14:34:07.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 200,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07ae",
    end_time: "2024-03-01T17:52:42.000Z",
    num_moves: 27,
    start_time: "2024-03-01T17:44:19.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 503,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07ad",
    end_time: "2024-03-01T17:44:13.000Z",
    num_moves: 9,
    start_time: "2024-03-01T17:43:12.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 61,
    result: "draw",
  },
  {
    _id: "663506d2de23f494a65a07b1",
    end_time: "2024-03-02T15:50:25.000Z",
    num_moves: 34,
    start_time: "2024-03-02T15:34:23.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 962,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07b3",
    end_time: "2024-03-04T14:58:29.000Z",
    num_moves: 40,
    start_time: "2024-03-04T14:45:08.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 801,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07b2",
    end_time: "2024-03-02T16:01:43.000Z",
    num_moves: 30,
    start_time: "2024-03-02T15:50:22.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 681,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07b4",
    end_time: "2024-03-04T18:00:27.000Z",
    num_moves: 20,
    start_time: "2024-03-04T17:56:13.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 254,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07b6",
    end_time: "2024-03-05T14:54:59.000Z",
    num_moves: 44,
    start_time: "2024-03-05T14:40:09.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 890,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07b5",
    end_time: "2024-03-04T18:16:21.000Z",
    num_moves: 34,
    start_time: "2024-03-04T18:00:27.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 954,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07b7",
    end_time: "2024-03-05T17:05:05.000Z",
    num_moves: 22,
    start_time: "2024-03-05T16:59:08.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 357,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07b8",
    end_time: "2024-03-05T17:20:59.000Z",
    num_moves: 58,
    start_time: "2024-03-05T17:05:16.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 943,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07b9",
    end_time: "2024-03-06T14:46:25.000Z",
    num_moves: 41,
    start_time: "2024-03-06T14:32:57.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 808,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07ba",
    end_time: "2024-03-06T17:43:53.000Z",
    num_moves: 43,
    start_time: "2024-03-06T17:27:48.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 965,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07bb",
    end_time: "2024-03-06T18:44:00.000Z",
    num_moves: 57,
    start_time: "2024-03-06T18:24:43.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1157,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07bc",
    end_time: "2024-03-06T19:31:29.000Z",
    num_moves: 74,
    start_time: "2024-03-06T19:16:41.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 888,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07bd",
    end_time: "2024-03-06T21:31:19.000Z",
    num_moves: 40,
    start_time: "2024-03-06T21:22:33.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 526,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07be",
    end_time: "2024-03-06T21:42:13.000Z",
    num_moves: 26,
    start_time: "2024-03-06T21:32:08.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 605,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07bf",
    end_time: "2024-03-08T14:56:23.000Z",
    num_moves: 26,
    start_time: "2024-03-08T14:49:02.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 441,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07c0",
    end_time: "2024-03-08T15:11:16.000Z",
    num_moves: 40,
    start_time: "2024-03-08T14:56:30.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 886,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07af",
    end_time: "2024-03-01T18:03:26.000Z",
    num_moves: 30,
    start_time: "2024-03-01T17:55:16.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 490,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07b0",
    end_time: "2024-03-02T15:34:17.000Z",
    num_moves: 19,
    start_time: "2024-03-02T15:29:01.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 316,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07c3",
    end_time: "2024-03-08T21:16:37.000Z",
    num_moves: 19,
    start_time: "2024-03-08T21:11:47.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 290,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07c4",
    end_time: "2024-03-09T16:16:03.000Z",
    num_moves: 45,
    start_time: "2024-03-09T15:58:54.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1029,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07c5",
    end_time: "2024-03-09T16:38:48.000Z",
    num_moves: 31,
    start_time: "2024-03-09T16:26:53.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 715,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07c6",
    end_time: "2024-03-09T18:09:28.000Z",
    num_moves: 36,
    start_time: "2024-03-09T17:52:46.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1002,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07c8",
    end_time: "2024-03-11T13:39:26.000Z",
    num_moves: 41,
    start_time: "2024-03-11T13:25:03.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 863,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07c7",
    end_time: "2024-03-11T13:24:01.000Z",
    num_moves: 19,
    start_time: "2024-03-11T13:18:55.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 306,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07c9",
    end_time: "2024-03-11T16:26:13.000Z",
    num_moves: 37,
    start_time: "2024-03-11T16:12:40.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 813,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07ca",
    end_time: "2024-03-11T16:41:59.000Z",
    num_moves: 47,
    start_time: "2024-03-11T16:26:45.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 914,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07cd",
    end_time: "2024-03-12T13:37:32.000Z",
    num_moves: 24,
    start_time: "2024-03-12T13:32:39.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 293,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07cc",
    end_time: "2024-03-11T19:31:56.000Z",
    num_moves: 35,
    start_time: "2024-03-11T19:20:14.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 702,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07cb",
    end_time: "2024-03-11T19:20:02.000Z",
    num_moves: 49,
    start_time: "2024-03-11T19:07:30.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 752,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07ce",
    end_time: "2024-03-12T13:46:14.000Z",
    num_moves: 50,
    start_time: "2024-03-12T13:37:34.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 520,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07cf",
    end_time: "2024-03-12T16:36:35.000Z",
    num_moves: 48,
    start_time: "2024-03-12T16:17:43.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1132,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07d1",
    end_time: "2024-03-13T14:06:09.000Z",
    num_moves: 46,
    start_time: "2024-03-13T13:53:43.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 746,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07d2",
    end_time: "2024-03-13T16:57:37.000Z",
    num_moves: 28,
    start_time: "2024-03-13T16:48:06.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 571,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07d0",
    end_time: "2024-03-13T13:53:30.000Z",
    num_moves: 23,
    start_time: "2024-03-13T13:48:20.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 310,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07d3",
    end_time: "2024-03-13T17:16:36.000Z",
    num_moves: 49,
    start_time: "2024-03-13T16:58:03.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1113,
    result: "draw",
  },
  {
    _id: "663506d2de23f494a65a07d4",
    end_time: "2024-03-13T20:01:10.000Z",
    num_moves: 35,
    start_time: "2024-03-13T19:49:53.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 677,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07d5",
    end_time: "2024-03-13T20:17:10.000Z",
    num_moves: 40,
    start_time: "2024-03-13T20:01:09.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 961,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07d7",
    end_time: "2024-03-14T17:58:50.000Z",
    num_moves: 49,
    start_time: "2024-03-14T17:43:42.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 908,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07d6",
    end_time: "2024-03-14T13:43:06.000Z",
    num_moves: 27,
    start_time: "2024-03-14T13:36:42.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 384,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07d9",
    end_time: "2024-03-15T14:06:50.000Z",
    num_moves: 72,
    start_time: "2024-03-15T13:49:40.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1030,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07d8",
    end_time: "2024-03-15T13:49:41.000Z",
    num_moves: 36,
    start_time: "2024-03-15T13:36:53.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 768,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07c1",
    end_time: "2024-03-08T19:00:21.000Z",
    num_moves: 64,
    start_time: "2024-03-08T18:40:30.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1191,
    result: "draw",
  },
  {
    _id: "663506d2de23f494a65a07db",
    end_time: "2024-03-18T14:01:44.000Z",
    num_moves: 37,
    start_time: "2024-03-18T13:46:16.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 928,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07dc",
    end_time: "2024-03-18T14:13:59.000Z",
    num_moves: 52,
    start_time: "2024-03-18T14:01:54.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 725,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07df",
    end_time: "2024-03-18T22:02:30.000Z",
    num_moves: 43,
    start_time: "2024-03-18T21:47:07.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 923,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07dd",
    end_time: "2024-03-18T16:42:48.000Z",
    num_moves: 55,
    start_time: "2024-03-18T16:25:33.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1035,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07de",
    end_time: "2024-03-18T19:30:50.000Z",
    num_moves: 40,
    start_time: "2024-03-18T19:15:42.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 908,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07e0",
    end_time: "2024-03-19T13:51:42.000Z",
    num_moves: 31,
    start_time: "2024-03-19T13:40:34.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 668,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07c2",
    end_time: "2024-03-08T21:11:40.000Z",
    num_moves: 26,
    start_time: "2024-03-08T21:05:15.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 385,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07e4",
    end_time: "2024-03-20T14:00:41.000Z",
    num_moves: 33,
    start_time: "2024-03-20T13:49:59.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 642,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07e3",
    end_time: "2024-03-19T20:28:26.000Z",
    num_moves: 74,
    start_time: "2024-03-19T20:08:05.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1221,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07e2",
    end_time: "2024-03-19T19:44:23.000Z",
    num_moves: 16,
    start_time: "2024-03-19T19:39:04.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 319,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07e5",
    end_time: "2024-03-20T17:11:35.000Z",
    num_moves: 49,
    start_time: "2024-03-20T16:56:15.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 920,
    result: "draw",
  },
  {
    _id: "663506d2de23f494a65a07e6",
    end_time: "2024-03-21T14:17:38.000Z",
    num_moves: 34,
    start_time: "2024-03-21T14:06:21.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 677,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07e7",
    end_time: "2024-03-21T16:46:00.000Z",
    num_moves: 57,
    start_time: "2024-03-21T16:26:42.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1158,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07e8",
    end_time: "2024-03-21T16:51:19.000Z",
    num_moves: 19,
    start_time: "2024-03-21T16:46:47.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 272,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07e9",
    end_time: "2024-03-22T00:15:51.000Z",
    num_moves: 47,
    start_time: "2024-03-15T23:09:21.000Z",
    time_class: "daily",
    time_control: "1/432000",
    match_length: 522390,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07ea",
    end_time: "2024-03-25T00:20:19.000Z",
    num_moves: 28,
    start_time: "2024-03-22T00:59:30.000Z",
    time_class: "daily",
    time_control: "1/432000",
    match_length: 256849,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07eb",
    end_time: "2024-03-25T13:59:36.000Z",
    num_moves: 58,
    start_time: "2024-03-25T13:45:30.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 846,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07ed",
    end_time: "2024-03-25T16:46:51.000Z",
    num_moves: 64,
    start_time: "2024-03-25T16:31:27.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 924,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07ec",
    end_time: "2024-03-25T16:31:30.000Z",
    num_moves: 47,
    start_time: "2024-03-25T16:17:23.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 847,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07ee",
    end_time: "2024-03-25T20:21:00.000Z",
    num_moves: 55,
    start_time: "2024-03-25T20:01:15.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1185,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07ef",
    end_time: "2024-03-26T13:54:28.000Z",
    num_moves: 36,
    start_time: "2024-03-26T13:41:21.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 787,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07f0",
    end_time: "2024-03-26T16:37:14.000Z",
    num_moves: 22,
    start_time: "2024-03-26T16:30:04.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 430,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07f1",
    end_time: "2024-03-26T16:57:02.000Z",
    num_moves: 34,
    start_time: "2024-03-26T16:39:11.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1071,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07f2",
    end_time: "2024-03-27T13:41:56.000Z",
    num_moves: 58,
    start_time: "2024-03-27T13:33:52.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 484,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07f4",
    end_time: "2024-03-27T14:09:01.000Z",
    num_moves: 76,
    start_time: "2024-03-27T13:50:08.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1133,
    result: "draw",
  },
  {
    _id: "663506d2de23f494a65a07f3",
    end_time: "2024-03-27T13:49:54.000Z",
    num_moves: 38,
    start_time: "2024-03-27T13:41:58.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 476,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07f5",
    end_time: "2024-03-27T16:22:07.000Z",
    num_moves: 59,
    start_time: "2024-03-27T16:05:31.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 996,
    result: "draw",
  },
  {
    _id: "663506d2de23f494a65a07f6",
    end_time: "2024-03-27T18:54:20.000Z",
    num_moves: 24,
    start_time: "2024-03-27T18:49:48.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 272,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07f7",
    end_time: "2024-03-27T19:07:40.000Z",
    num_moves: 39,
    start_time: "2024-03-27T18:54:32.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 788,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07f8",
    end_time: "2024-03-27T21:59:05.000Z",
    num_moves: 83,
    start_time: "2024-03-27T21:41:35.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1050,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07f9",
    end_time: "2024-03-27T22:06:19.000Z",
    num_moves: 32,
    start_time: "2024-03-27T21:59:44.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 395,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07fa",
    end_time: "2024-03-27T22:10:29.000Z",
    num_moves: 24,
    start_time: "2024-03-27T22:06:26.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 243,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07fc",
    end_time: "2024-03-27T22:42:18.000Z",
    num_moves: 47,
    start_time: "2024-03-27T22:28:22.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 836,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07fb",
    end_time: "2024-03-27T22:28:09.000Z",
    num_moves: 47,
    start_time: "2024-03-27T22:10:55.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1034,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07fd",
    end_time: "2024-03-28T13:57:14.000Z",
    num_moves: 41,
    start_time: "2024-03-28T13:39:55.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1039,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07da",
    end_time: "2024-03-15T18:27:13.000Z",
    num_moves: 53,
    start_time: "2024-03-15T18:13:27.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 826,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a07fe",
    end_time: "2024-03-28T16:23:30.000Z",
    num_moves: 36,
    start_time: "2024-03-28T16:15:18.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 492,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a0800",
    end_time: "2024-03-28T16:37:52.000Z",
    num_moves: 42,
    start_time: "2024-03-28T16:26:50.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 662,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a0801",
    end_time: "2024-03-28T16:40:16.000Z",
    num_moves: 21,
    start_time: "2024-03-28T16:37:56.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 140,
    result: "lose",
  },
  {
    _id: "663506d2de23f494a65a0803",
    end_time: "2024-03-30T01:09:24.000Z",
    num_moves: 62,
    start_time: "2024-03-25T00:30:37.000Z",
    time_class: "daily",
    time_control: "1/432000",
    match_length: 434327,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a0802",
    end_time: "2024-03-28T19:02:36.000Z",
    num_moves: 52,
    start_time: "2024-03-28T18:49:40.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 776,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07e1",
    end_time: "2024-03-19T17:07:43.000Z",
    num_moves: 55,
    start_time: "2024-03-19T16:49:01.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 1122,
    result: "win",
  },
  {
    _id: "663506d2de23f494a65a07ff",
    end_time: "2024-03-28T16:26:46.000Z",
    num_moves: 18,
    start_time: "2024-03-28T16:23:38.000Z",
    time_class: "rapid",
    time_control: "600",
    match_length: 188,
    result: "win",
  },
];
durationRes.forEach((el) => (el.match_length = el.match_length / 60));

const scatterPlot = new ScatterPlot({
  heading: "Number of Moves by Match Length",
  canvas: d3.select(".canvas--duration-stats"),
  keys: ["win", "draw", "lose"],
  filterGroups: [["time_class", ["rapid", "daily", "blitz", "bullet"]]],
  sortGroups: [],
});

scatterPlot.createLegend("rect", "after");
scatterPlot.createAxisLabel({
  x: "Match length (minutes)",
  y: "# of moves",
});
scatterPlot.bindData(durationRes);
console.log(scatterPlot);
